{% extends "pages_client/base.html" %}
{% block title %}My Orders{% endblock %}

{% block content %}
<div class="container py-4">

    <!-- Page header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="mb-1">My Orders</h2>
            <p class="text-muted mb-0">See all of your orders</p>
        </div>

        <a href="{{ url_for('client.make_order') }}" class="btn btn-primary">
            <i class="bi bi-plus-lg me-1"></i>
            New order
        </a>
    </div>

    {% if order_amount == 0 %}
        <!-- No orders -->
        <div class="card text-center py-5">
            <div class="card-body">
                <i class="bi bi-box-seam display-1 text-muted mb-3"></i>
                <p class="text-muted mb-3">You don’t have any orders yet</p>
                <a href="{{ url_for('client.make_order') }}" class="btn btn-primary">
                    Create your first order
                </a>
            </div>
        </div>
    {% else %}
        <!-- Orders list -->
        <div class="d-flex flex-column gap-4">

            {% for order in order_list %}
            {% set price = (order.get('price') or 0) %}
            {% set weight = (order.get('package_weight') or order.get('packageWeight') or 0) %}
            {% set package_desc = (order.get('package_description') or order.get('packageDescription') or "—") %}
            {% set instructions = (order.get('special_instructions') or order.get('specialInstructions') or "") %}

            <div class="card shadow-sm order-card"
                 role="button"
                 onclick="window.location.href='{{ url_for('client.order_by_id', orderid=order['order_id']) }}'">

                <!-- Card header -->
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">Order #{{ order['order_id'] }}</h5>

                    {% if order['status'] == 'pending' %}
                        <span class="badge bg-secondary">Pending</span>
                    {% elif order['status'] == 'assigned' %}
                        <span class="badge bg-info text-dark">Assigned</span>
                    {% elif order['status'] == 'in_transit' %}
                        <span class="badge bg-primary">In transit</span>
                    {% elif order['status'] == 'delivered' %}
                        <span class="badge bg-success">Delivered</span>
                    {% elif order['status'] == 'cancelled' %}
                        <span class="badge bg-danger">Cancelled</span>
                    {% endif %}
                </div>

                <!-- Card body -->
                <div class="card-body">
                    <div class="row g-3">

                        <div class="col-lg-4">
                            <p class="text-muted small mb-1">From</p>
                            <p class="mb-0">{{ order['pickup_address'] }}</p>
                        </div>

                        <div class="col-lg-4">
                            <p class="text-muted small mb-1">To</p>
                            <p class="mb-0">{{ order['delivery_address'] }}</p>
                        </div>

                        <div class="col-lg-2">
                            <p class="text-muted small mb-1">Weight</p>
                            <p class="mb-0">{{ "%.2f"|format(weight) }} kg</p>
                        </div>

                        <div class="col-lg-2">
                            <p class="text-muted small mb-1">Price</p>
                            <p class="mb-0">€{{ "%.2f"|format(price) }}</p>
                        </div>

                        <div class="col-12">
                            <p class="text-muted small mb-1">Package</p>
                            <p class="mb-0">{{ package_desc }}</p>
                        </div>

                        {% if instructions|trim %}
                        <div class="col-12">
                            <p class="text-muted small mb-1">Special instructions</p>
                            <p class="mb-0">{{ instructions }}</p>
                        </div>
                        {% endif %}

                    </div>
                </div>
            </div>
            {% endfor %}

        </div>
    {% endif %}

</div>

<style>
.order-card {
    cursor: pointer;
    transition: box-shadow 0.2s ease-in-out, transform 0.2s ease-in-out;
}

.order-card:hover {
    box-shadow: 0 0.75rem 1.5rem rgba(0, 0, 0, 0.15);
    transform: translateY(-2px);
}
</style>
{% endblock %}
